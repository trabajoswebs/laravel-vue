app/
- **Domain/** – Reglas puras sin depender de Laravel.
  - **User/**: `User.php`; `Contracts/MediaOwner.php`; perfiles `Profiles/AvatarProfile.php`, `Profiles/GalleryProfile.php`; conversión `ConversionProfiles/AvatarConversionProfile.php`, `ConversionProfiles/FileConstraints.php`.
  - **Media/**: `ImageProfile.php`; DTO `ConversionExpectations.php`, `ReplacementResult.php`, `ReplacementSnapshot.php`, `ReplacementSnapshotItem.php`.
  - **Security/**: `SecurityHelper.php`, `RateLimitSignatureFactory.php`.
  - **Sanitization/**: `DisplayName.php`.

- **Application/** – Casos de uso y orquestación.
  - **Http/Requests/**: `Auth/LoginRequest.php`; `Concerns/SanitizesInputs.php`; `Settings/{DeleteAvatarRequest,ProfileUpdateRequest,UpdateAvatarRequest}.php`; `UploadImageRequest.php`.
  - **Media/**: Coordinador `Coordinators/MediaLifecycleCoordinator.php`; servicios `Services/{MediaCleanupScheduler,MediaReplacementService}.php`; DTO `DTO/{CleanupPayload,CleanupStatePayload}.php`.
  - **User/**: Actions `{DeleteAvatar,UpdateAvatar}.php`; Events `{AvatarDeleted,AvatarUpdated}.php`; Jobs `{CleanupMediaArtifactsJob,PerformConversionsJob,PostProcessAvatarMedia}.php`; Listeners `{QueueAvatarPostProcessing,RunPendingMediaCleanup}.php`; Policies `Policies/UserPolicy.php` y `Policies/Concerns/HandlesMediaOwnership.php`.

- **Infrastructure/** – Adaptadores técnicos y framework.
  - **Console/**: `Kernel.php`; Commands `{CleanAuditLogs,QuarantineCleanupSidecarsCommand,QuarantinePruneCommand}.php`.
  - **Http/**: Controladores Auth/Settings/Media/Language y base `Controller.php`; Middleware `{HandleAppearance,HandleInertiaRequests,PreventBruteForce,RateLimitUploads,SanitizeInput,SecurityHeaders,TrustProxies,UserAudit}.php`; Rules `Http/Rules/SecureImageValidation.php`.
  - **Localization/**: `TranslationService.php`.
  - **Media/**:
    - Concerns `Concerns/GuardsUploadedImage.php`.
    - Pipeline `ImagePipeline.php` + `ImagePipeline/{FallbackWorkflow,ImagickWorkflow,PipelineArtifacts,PipelineConfig,PipelineLogger,ImageProcessingException}.php`; `ImagePipelineResult.php`.
    - Upload `Upload/Contracts/*`, `Upload/Core/LocalQuarantineRepository.php`, `Upload/Core/QuarantineRepository.php`, `Upload/DefaultUploadPipeline.php`, `Upload/DefaultUploadService.php`, `Upload/Scanning/ScanCoordinator.php`, `Upload/Support/{ImageUploadReporter,QuarantineManager}.php`, `Upload/Exceptions/*.php`, `ImageUploadPipelineAdapter.php`.
    - Optimizer `OptimizerService.php`, adapters `Optimizer/Adapters/{LocalOptimizationAdapter,RemoteDownloader,RemoteUploader}.php`.
    - Security `Security/{ImageMetadataReader,ImageNormalizer,MimeNormalizer,PayloadScanner,UploadValidationLogger}.php`; scanners `{AbstractScanner,ClamAvScanner,YaraScanner}.php`.
    - Providers `{ImagePipelineServiceProvider,MediaLibraryBindingsServiceProvider}.php`.
    - Models `Models/MediaCleanupState.php`; util `MediaArtifactCollector.php`; Concerns `Models/Concerns/TracksMediaVersions.php`; Observers `Observers/MediaObserver.php`.
  - **Providers/**: `AppServiceProvider.php`, `AuthServiceProvider.php`, `EventServiceProvider.php`, `HtmlPurifierServiceProvider.php`.
  - **Security/**: `AvatarHeaderInspector.php`.

- **Shared (root)**:
  - `Console/Kernel.php` (alias al Kernel de Infrastructure).
  - `README.md`.
