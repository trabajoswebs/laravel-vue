app/
  Actions/
    Profile/ (delete/update avatar actions con locking y eventos)
  Console/
    Kernel.php – registra comandos y planifica `quarantine:*`
    Commands/
      CleanAuditLogs.php – limpia logs históricos
      QuarantinePruneCommand.php – llama a `QuarantineRepository::pruneStaleFiles`
      QuarantineCleanupSidecarsCommand.php – elimina sidecars `.sha256` huérfanos
  Events/ (AvatarDeleted, AvatarUpdated)
  Helpers/ (SecurityHelper, AvatarHeaderInspector)
  Http/
    Controllers/ (auth, settings, media con Inertia)
    Middleware/ (SecurityHeaders, RateLimitUploads, SanitizeInput, etc.)
    Requests/ (LoginRequest, UpdateAvatarRequest, UploadImageRequest…)
  Jobs/ (CleanupMediaArtifactsJob, PostProcessAvatarMedia)
  Listeners/ (QueueAvatarPostProcessing, RunPendingMediaCleanup)
  Models/
    User.php + trait TracksMediaVersions
  Observers/
    MediaObserver.php – monitoriza eventos de Spatie
  Policies/
    UserPolicy y trait HandlesMediaOwnership
  Providers/
    AppServiceProvider – bindings y comandos
    ImagePipelineServiceProvider – valida `config/image-pipeline.php`, alias middleware
    MediaLibraryBindings/HtmlPurifier/Auth/Event providers
  Rules/
    SecureImageValidation – única entrada para archivos
  Services/
    ImagePipeline/ (config, workflows Imagick/GD, logger, artifacts)
    ImagePipelineResult / ImageUploadService / OptimizerService
    Upload/
      Contracts – UploadPipeline, UploadResult, UploadMetadata, UploadService
      Core – LocalQuarantineRepository (hash sidecar, prune/cleanup), QuarantineRepository interface
      DefaultUploadPipeline / DefaultUploadService / ImageUploadPipelineAdapter
      Exceptions – VirusDetectedException, UploadValidationException, etc.
    Security/Scanners – ClamAV, YARA, AbstractScanner
    TranslationService, DocumentPipeline placeholder
  Support/
    Media (perfiles, DTOs, scheduler, replacement service, security normalizers, contracts)
    Documents/Profiles (placeholder para workflows futuros)
    Sanitization/DisplayName
    Security/RateLimitSignatureFactory
